"use strict";(self["webpackChunknetflixkekw"]=self["webpackChunknetflixkekw"]||[]).push([[869],{9863:function(e,t,s){s.d(t,{A:function(){return R}});var i=s(6768);const l={class:"root"},a={class:"header"},o={class:"container header__wrapper"},n={key:0,class:"header__authorize"};function r(e,t,s,r,c,d){const p=(0,i.g2)("PopupBlock"),m=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",l,[c.isPopUpClosed?((0,i.uX)(),(0,i.Wv)(p,{key:0,onCloseByWrapper:t[0]||(t[0]=e=>{c.isPopUpClosed=e}),onClosePopUp:t[1]||(t[1]=e=>{c.isPopUpClosed=e})})):(0,i.Q3)("",!0),(0,i.Lk)("header",a,[(0,i.Lk)("div",o,[t[5]||(t[5]=(0,i.Lk)("a",{href:"/Zetflix/",class:"header__title"},[(0,i.Lk)("span",{class:"bigLogo"},"NETFLIX"),(0,i.Lk)("br"),(0,i.eW)("and chill")],-1)),this.userAuthorize?((0,i.uX)(),(0,i.CE)("div",n,[(0,i.Lk)("div",{onClick:t[2]||(t[2]=e=>c.isPopUpClosed=!0),class:"btn"},"Добавить фильмец"),(0,i.bF)(m,{to:"/login-form",onClick:d.clearLocalStorage,class:"btn"},{default:(0,i.k6)((()=>t[3]||(t[3]=[(0,i.eW)("Выйти")]))),_:1},8,["onClick"])])):((0,i.uX)(),(0,i.Wv)(m,{key:1,to:"/login-form",class:"header__enter btn"},{default:(0,i.k6)((()=>t[4]||(t[4]=[(0,i.eW)("Войти")]))),_:1}))])])])}var c=s(4232),d=s.p+"img/search-svg.9cdd2e0b.svg";const p={class:"popup"},m={class:"popup__top"},u={key:0,class:"popup__attention"},h={key:1,class:"popup__films"},_={class:"popup__films-columns"},k={key:0,class:"popup__films-context"},f={class:"popup__films-content"},v=["src"],g={class:"popup__film-texts"},y={class:"popup__context-title"},F={class:"popup__context-year"},C={class:"popup__context-genres"},b={class:"popup__context-description"};function L(e,t,s,l,a,o){const n=(0,i.g2)("inputComponent"),r=(0,i.g2)("addMovieCard");return(0,i.uX)(),(0,i.CE)("div",{class:"popup__wrapper",onClick:t[5]||(t[5]=t=>e.$emit("CloseByWrapper",o.wrapperCheck(t)))},[(0,i.Lk)("div",p,[(0,i.Lk)("div",{class:"popup__close",onClick:t[0]||(t[0]=t=>e.$emit("ClosePopUp",!1))},"Х"),t[7]||(t[7]=(0,i.Lk)("h2",{class:"popup__title"},"Впиши название фильма ",-1)),(0,i.Lk)("div",m,[(0,i.bF)(n,{class:"popup__input",onKeypress:t[1]||(t[1]=e=>o.checkKeyPress(e.key)),onReturnValue:t[2]||(t[2]=e=>this.filmName=e),textForPlaceholder:"Название фильма",error:this.errorText},null,8,["error"]),(0,i.Lk)("div",{class:"popup__btn",onClick:t[3]||(t[3]=e=>o.findFilm())},t[6]||(t[6]=[(0,i.Lk)("img",{src:d,alt:"",class:"popup__btn-img"},null,-1)]))]),0==this.listOfFindedFilms.length?((0,i.uX)(),(0,i.CE)("div",u,"Данная параша работает по бесплатному API ключу, потому что маленькая инди компания Yandex не может позволить себе больше 200 бесплатных запросов(Привет ютубу, где я делал по 1000+ в день).Так что динамического поиска тут нет, просьба писать название фильма без ошибок на всякий пожарный =)")):((0,i.uX)(),(0,i.CE)("div",h,[(0,i.Lk)("div",_,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(this.listOfFindedFilms.docs,((e,t)=>((0,i.uX)(),(0,i.Wv)(r,{onCheckFilm:e=>{this.indexOfFilms=e,this.isClicked=!0},key:t,name:e.name,index:t,desc:e.description,year:e.year},null,8,["onCheckFilm","name","index","desc","year"])))),128))]),a.isClicked?((0,i.uX)(),(0,i.CE)("div",k,[(0,i.Lk)("div",f,[(0,i.Lk)("img",{src:this.listOfFindedFilms.docs[a.indexOfFilms].poster.previewUrl,alt:"Картинка для фильма",class:"popup__content-img"},null,8,v),(0,i.Lk)("div",g,[(0,i.Lk)("div",y,(0,c.v_)(this.listOfFindedFilms.docs[a.indexOfFilms].name),1),(0,i.Lk)("div",F,(0,c.v_)(this.listOfFindedFilms.docs[a.indexOfFilms].year)+" - года ",1),(0,i.Lk)("div",C,"Жанры: "+(0,c.v_)(o.makeGenres()),1),(0,i.Lk)("div",b,(0,c.v_)(this.listOfFindedFilms.docs[a.indexOfFilms].description),1)])]),(0,i.Lk)("div",{class:"popup__context-btn btn",onClick:t[4]||(t[4]=e=>o.addNewFilm())},"Добавить")])):(0,i.Q3)("",!0)]))])])}const w={class:"film__content"},O={class:"film__title"};function x(e,t,s,l,a,o){return(0,i.uX)(),(0,i.CE)("div",{class:"wrapper__film",onClick:t[0]||(t[0]=t=>e.$emit("checkFilm",this.index))},[(0,i.Lk)("div",w,[(0,i.Lk)("div",O,(0,c.v_)(this.name)+" - "+(0,c.v_)(this.year)+" года",1)])])}var E={data(){return{}},props:["index","name","desc","year"]},S=s(1241);const A=(0,S.A)(E,[["render",x],["__scopeId","data-v-7e13947d"]]);var P=A,I=s(2484),$=s(5064),N={data(){return{indexOfFilms:0,isClicked:!1,filmName:"",errorText:"",listOfFindedFilms:[],films:[]}},components:{inputComponent:I.A,addMovieCard:P},methods:{wrapperCheck(e){return!e.target.classList.contains("popup__wrapper")||(console.log(e.target),!1)},async findFilm(){if(""==this.filmName)this.errorText="Название фильма напиши даун)";else try{this.errorText="";let e=await fetch(`https://api.kinopoisk.dev/v1.4/movie/search?page=1&limit=10&query=${this.filmName}`,{method:"GET",headers:{accept:"application/json","X-API-KEY":"0ZGKZ63-NXGMT2M-K6VBGQZ-4Y50733"}});this.listOfFindedFilms=await e.json()}catch(e){console.log(e)}},checkKeyPress(e){console.log(),"Enter"==e&&this.findFilm()},async addNewFilm(){try{await fetch("https://1d95bdc879b5963a.mokky.dev/films",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({filmName:this.listOfFindedFilms.docs[this.indexOfFilms].name,year:this.listOfFindedFilms.docs[this.indexOfFilms].year,imgPath:this.listOfFindedFilms.docs[this.indexOfFilms].poster.previewUrl,whoSendIt:JSON.parse(localStorage.getItem("user")).name,status:"Предложенные"})}),this.films=(0,$.H)(),this.films.getFilms()}catch(e){console.log(e)}},makeGenres(){let e="";for(let t in this.listOfFindedFilms.docs[this.indexOfFilms].genres)e+=` ${this.listOfFindedFilms.docs[this.indexOfFilms].genres[t].name},`;return e.substring(0,e.length-1)}}};const X=(0,S.A)(N,[["render",L],["__scopeId","data-v-794c3ed8"]]);var T=X,W={components:{PopupBlock:T},data(){return{userData:{},userAuthorize:!1,isPopUpClosed:!1}},created(){localStorage.getItem("user")&&(this.userAuthorize=!0,this.userData=JSON.parse(localStorage.getItem("user")))},methods:{clearLocalStorage(){localStorage.removeItem("user")}}};const j=(0,S.A)(W,[["render",r],["__scopeId","data-v-1836e288"]]);var R=j},2484:function(e,t,s){s.d(t,{A:function(){return m}});var i=s(6768),l=s(4232);const a={class:"wrapper__input"},o=["placeholder"],n={class:"input__error"};function r(e,t,s,r,c,d){return(0,i.uX)(),(0,i.CE)("div",a,[(0,i.Lk)("input",{type:"text",class:"input",placeholder:s.textForPlaceholder,onInput:t[0]||(t[0]=t=>e.$emit("returnValue",t.target.value))},null,40,o),(0,i.Lk)("div",n,(0,l.v_)(s.error),1)])}var c={data(){return{}},props:["textForPlaceholder","error"]},d=s(1241);const p=(0,d.A)(c,[["render",r],["__scopeId","data-v-a976c2ac"]]);var m=p},5736:function(e,t,s){s.r(t),s.d(t,{default:function(){return P}});var i=s(6768),l=s(4232),a=s.p+"img/cross.b92aa416.svg",o=s.p+"img/camera.2b960e47.svg",n=s.p+"img/remove.a84b7276.svg",r=s.p+"img/done.01e3c218.svg",c=s.p+"img/pen.d17cd3e1.svg";const d={class:"root"},p={key:0,class:"control__panel"},m={class:"control__list"},u={class:"container"},h={class:"filmPage__wrapper"},_={class:"filmPage__img-wrapper"},k=["src"],f={class:"filmPage__info-wrapper"},v={class:"filmInfo__title"},g={class:"filmInfo__year"},y=["value"],F={class:"filmInfo__ratings"},C={class:"asd"},b=["value"],L=["value"],w=["onClick"];function O(e,t,s,O,x,E){const S=(0,i.g2)("headerBlock");return(0,i.uX)(),(0,i.CE)("div",d,[x.isAdmin?((0,i.uX)(),(0,i.CE)("div",p,[(0,i.Lk)("ul",m,[(0,i.Lk)("li",{class:"control__list-controls btn",onClick:t[0]||(t[0]=e=>E.deleteFilm())},t[6]||(t[6]=[(0,i.Lk)("img",{src:a,alt:"",class:"controls__img"},null,-1),(0,i.eW)("Удалить")])),(0,i.Lk)("li",{class:"control__list-controls btn",onClick:t[1]||(t[1]=e=>E.inOrderFilm())},t[7]||(t[7]=[(0,i.Lk)("img",{src:o,alt:"",class:"controls__img"},null,-1),(0,i.eW)(" В очередь")])),(0,i.Lk)("li",{class:"control__list-controls btn",onClick:t[2]||(t[2]=e=>E.fromOrderFilm())},t[8]||(t[8]=[(0,i.Lk)("img",{src:n,alt:"",class:"controls__img"},null,-1),(0,i.eW)(" В Предложенные")])),(0,i.Lk)("li",{class:"control__list-controls btn",onClick:t[3]||(t[3]=e=>E.watchedFilm())},t[9]||(t[9]=[(0,i.Lk)("img",{src:r,alt:"",class:"controls__img"},null,-1),(0,i.eW)("Просмотрено")])),"Просмотрено"==this.film.status?((0,i.uX)(),(0,i.CE)("li",{key:0,class:"control__list-controls btn",onClick:t[4]||(t[4]=e=>E.editFilm())},[t[10]||(t[10]=(0,i.Lk)("img",{src:c,alt:"",class:"controls__img"},null,-1)),(0,i.eW)((0,l.v_)(x.isEdit?"Сохранить":"Редактировать"),1)])):(0,i.Q3)("",!0)])])):(0,i.Q3)("",!0),(0,i.bF)(S),(0,i.Lk)("div",u,[(0,i.Lk)("div",h,[(0,i.Lk)("div",_,[(0,i.Lk)("img",{src:this.film.imgPath,alt:"картинка фильма",class:"filmPage__img"},null,8,k)]),(0,i.Lk)("div",f,[(0,i.Lk)("h1",v,(0,l.v_)(this.film.filmName),1),(0,i.Lk)("div",g,(0,l.v_)(this.film.year)+" - года",1),(0,i.Lk)("input",{readonly:"",value:this.film.desc,class:"filmInfo__commentary",placeholder:"Короткий комментарий по фильму"},null,8,y)]),(0,i.Lk)("div",F,[t[12]||(t[12]=(0,i.Lk)("div",{class:"filmInfo__ratings-text"},"Оценки зрителей:",-1)),this.isEdit?((0,i.uX)(),(0,i.CE)("div",{key:0,class:"filmInfo__ratings-add",onClick:t[5]||(t[5]=e=>E.addNewRateField())})):(0,i.Q3)("",!0),(0,i.Lk)("div",C,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(Object.keys(this.onSiteRanks).length,((e,s)=>((0,i.uX)(),(0,i.CE)("div",{class:"rating__wrapper",key:s},[(0,i.Lk)("input",{readonly:"",type:"text",value:Object.keys(this.onSiteRanks)[s],class:"rating__wrapper-input rating__wrapper-name",placeholder:"Имя зрителя"},null,8,b),(0,i.Lk)("input",{readonly:"",type:"text",value:Object.values(this.onSiteRanks)[s],class:"rating__wrapper-input rating__wrapper-rate",placeholder:"Оценка зрителя"},null,8,L),this.isEdit?((0,i.uX)(),(0,i.CE)("div",{key:0,class:"rating__wrapper-deleteRate",onClick:e=>E.removeField(s)},t[11]||(t[11]=[(0,i.Lk)("img",{src:a,alt:"",class:"controls__img"},null,-1)]),8,w)):(0,i.Q3)("",!0)])))),128))])])])])])}s(8992),s(3949);var x=s(9863),E={components:{headerBlock:x.A},data(){return{film:"",isAdmin:!1,isEdit:!1,onSiteRanks:{},additionalField:0}},updated(){},methods:{removeField(e){delete this.onSiteRanks[Object.keys(this.onSiteRanks)[e]]},addNewRateField(){this.additionalField++;let e=document.querySelectorAll(".rating__wrapper-input"),t={};for(let s=0;s<e.length;s+=2)t[e[s].value]=Number(e[s+1].value);console.log(t),t[`Новое поле ${this.additionalField}`]=0,console.log(t),this.onSiteRanks=t,setTimeout((()=>{let e=document.querySelectorAll(".rating__wrapper-input");e.forEach((e=>{e.removeAttribute("readonly")}))}),100)},async deleteFilm(){await fetch(`https://1d95bdc879b5963a.mokky.dev/films/${this.$route.params.id}`,{method:"DELETE",headers:{"content-type":"application/json"}}),window.location="/Zetflix/"},async inOrderFilm(){await fetch(`https://1d95bdc879b5963a.mokky.dev/films/${this.$route.params.id}`,{method:"PATCH",headers:{"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify({status:"В очереди",timeOfWatch:"",ranks:"",desc:""})}),location.reload()},async fromOrderFilm(){await fetch(`https://1d95bdc879b5963a.mokky.dev/films/${this.$route.params.id}`,{method:"PATCH",headers:{"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify({status:"Предложенные",timeOfWatch:""})}),location.reload()},async watchedFilm(){let e=new Date,t=`${e.getDay()}.${e.getMonth()+1}.${e.getFullYear()} - ${e.getHours()}:${e.getMinutes()}`;await fetch(`https://1d95bdc879b5963a.mokky.dev/films/${this.$route.params.id}`,{method:"PATCH",headers:{"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify({status:"Просмотрено",timeOfWatch:t})}),location.reload()},async editFilm(){const e=document.querySelectorAll(".rating__wrapper-input"),t=document.querySelector(".filmInfo__commentary");if(this.isEdit){const s={};for(let t=0;t<e.length;t+=2)s[e[t].value]=Number(e[t+1].value);e.forEach((e=>{e.setAttribute("readonly",!0)})),t.setAttribute("readonly",!0),console.log(s),await fetch(`https://1d95bdc879b5963a.mokky.dev/films/${this.$route.params.id}`,{method:"PATCH",headers:{"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify({ranks:s,desc:t.value})}),location.reload()}else t.removeAttribute("readonly"),e.forEach((e=>{e.removeAttribute("readonly")}));this.isEdit=!this.isEdit}},async created(){"Админ"==JSON.parse(localStorage.getItem("user")).role&&(this.isAdmin=!0);let e=await fetch(`https://1d95bdc879b5963a.mokky.dev/films?id=${this.$route.params.id}`,{method:"GET",headers:{"content-type":"application/json"}});this.film=(await e.json())[0],this.film.ranks?this.onSiteRanks=this.film.ranks:this.onSiteRanks={}}},S=s(1241);const A=(0,S.A)(E,[["render",O],["__scopeId","data-v-79f84b6a"]]);var P=A}}]);
//# sourceMappingURL=869.651898ca.js.map